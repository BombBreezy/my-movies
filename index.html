<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cine-Log 2000 </title>
    <style>
        /* CORE 90s THEME */
        body { background-color: #000000; font-family: "Times New Roman", serif; color: black; margin: 20px; }
        #app-container { width: 95%; max-width: 900px; margin: 0 auto; background: #c0c0c0; border: 4px outset #ffffff; padding: 15px; box-shadow: 10px 10px 0px rgba(0,255,0,0.1); position: relative; min-height: 400px; }
        header { background: linear-gradient(90deg, #000080, #0808ff); color: white; padding: 10px; font-weight: bold; border: 2px inset #ffffff; margin-bottom: 15px; font-size: 1.5em; text-shadow: 2px 2px #000; }
        .box { border: 2px inset #ffffff; background: #c0c0c0; padding: 15px; margin-bottom: 15px; }
        
        /* TABLE & MONTH HEADERS */
        table { width: 100%; border-collapse: collapse; background: white; border: 2px inset #808080; }
        th { background: #808080; color: white; border: 1px solid #c0c0c0; padding: 8px; text-align: left; }
        td { border: 1px solid #808080; padding: 8px; font-family: "Courier New", monospace; }
        .month-header { background: #000080; color: #ffffff; font-weight: bold; text-align: center; letter-spacing: 2px; font-size: 0.9em; padding: 5px; }
        
        /* INTERACTIVE ELEMENTS */
        .movie-link { color: #0000ee; cursor: pointer; text-decoration: underline; font-weight: bold; }
        .movie-link:hover { color: #ff0000; }
        .del-btn { background: none; border: none; cursor: pointer; font-size: 1.2em; }
/* TICKET BUTTON STYLE */
        .ticket-btn { 
            background: #ff5555; 
            color: white; 
            border: 2px solid #a00; 
            font-weight: bold; 
            padding: 5px 15px; 
            cursor: pointer; 
            display: block; 
            width: 110px; 
            margin-left: auto; 
            clip-path: polygon(10% 0, 90% 0, 100% 20%, 100% 80%, 90% 100%, 10% 100%, 0 80%, 0 20%); 
            margin-bottom: 5px; 
            text-align: center; 
        }


        marquee { background: #000; color: #0f0; font-family: 'Courier New', monospace; padding: 5px; border: 1px solid #fff; margin-bottom: 15px; display: block; }
        .counter-pill { background: #fff; border: 2px inset #808080; padding: 5px 10px; font-weight: bold; color: #000080; }








        /* IMDb POP-UP WINDOW */
        #movie-modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); }
        .modal-content { background-color: #c0c0c0; margin: 10% auto; padding: 20px; border: 4px outset #fff; width: 80%; max-width: 500px; color: black; }
        .modal-header { background: #000080; color: white; padding: 5px; margin: -20px -20px 15px -20px; font-weight: bold; }
        .poster { float: left; margin-right: 15px; border: 2px inset #fff; width: 120px; background: #808080; }
        .clear { clear: both; }
        input, select { border: 2px inset #ffffff; padding: 5px; }
        button { background: #c0c0c0; border: 2px outset #ffffff; cursor: pointer; font-weight: bold; padding: 5px 10px; }




           /* NOIR FILTER CLASS */
        .noir-mode { 
            filter: grayscale(1) sepia(0.2) contrast(1.2); 
        }
        .noir-mode #app-container {
            box-shadow: 10px 10px 0px rgba(255,255,255,0.1) !important;
        }
        /* EXTRA NOIR JITTER */
        .noir-mode::before {
            content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.02); pointer-events: none; z-index: 10005;
            animation: flicker 0.1s infinite;
        }
        @keyframes flicker { 0% { opacity: 0.1; } 50% { opacity: 0.2; } 100% { opacity: 0.1; } }




       /* HACKER TERMINAL LOADING STYLE */
        #loading-stage { 
            display: none; 
            position: fixed; 
            top: 0; left: 0; width: 100%; height: 100%; 
            background-color: #000000; /* Solid Black */
            color: #00ff00; /* Bright Green */
            z-index: 9999; 
            align-items: center; 
            justify-content: center; 
            flex-direction: column;
            font-family: "Courier New", monospace;
        }
/* THE STATIC NOISE (Layer 1) */
        #static-noise {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://media.giphy.com/media/oEI9uBYSzLpBK/giphy.gif'); /* Classic TV Static */
            background-size: cover;
            opacity: 0.1; /* Subtle ghost effect */
            z-index: 10000; /* Sits behind text */
            pointer-events: none;
        }


        /* THE MOVING SCANLINE (Layer 3 - Overlays everything lightly) */
        #scanline {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 5px;
            background: rgba(0, 255, 0, 0.4);
            box-shadow: 0px 0px 10px #00ff00;
            animation: scan 4s linear infinite;
            z-index: 10002;
            pointer-events: none;
        }
        @keyframes scan { 0% { top: -10%; } 100% { top: 110%; } }


        /* ENSURE TEXT IS ON TOP (Layer 2) */
        #loading-text, .system-boot {
            position: relative;
            z-index: 10001; /* Higher than static! */
        }


        
        /* The "SYSTEM BOOT" indicator in top corner */
        .system-boot {
            position: absolute;
            top: 40px; left: 40px;
            color: #00ff00;
            border: 2px solid #00ff00;
            padding: 5px 10px;
            font-size: 1.5em;
            font-weight: bold;
            animation: blink 2s infinite;
            text-shadow: 0px 0px 5px #00ff00;
        }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }


        /* The Text Area */
        #loading-text { 
            color: #00ff00;
            font-size: 1.2em;
            text-align: center;
            width: 80%;
            max-width: 500px;
            text-shadow: 0px 0px 5px #005500;
        }


        /* The Green Progress Bar */
        #progress-container { width: 100%; border: 2px solid #00ff00; height: 20px; margin-top: 20px; background: #001100; }
        #progress-bar { width: 0%; height: 100%; background: #00ff00; box-shadow: 0px 0px 10px #00ff00; }






/* MOBILE OPTIMIZATION */
@media (max-width: 600px) {
    body { margin: 5px; background-color: #000; }
    #app-container { width: 100%; padding: 10px; margin: 0; border: none; }
    
    /* Stack inputs on phones */
    input, select, button { 
        width: 100%; 
        margin-bottom: 10px; 
        box-sizing: border-box; /* Keeps padding inside the width */
    }
    
    /* Adjust table for small screens */
    table { font-size: 0.8em; }
    th, td { padding: 4px; }
    
    /* Fix the modal for phones */
    .modal-content { width: 95%; margin: 20% auto; }
    .poster { float: none; display: block; margin: 0 auto 15px auto; }
}


/* NEW SCROLLING ENGINE */
        .scroller-container {
            background: #000;
            border: 1px solid #fff;
            color: #0f0;
            font-family: 'Courier New', monospace;
            overflow: hidden;
            white-space: nowrap;
            padding: 5px;
            margin-bottom: 15px;
        }
        .scrolling-text {
            display: inline-block;
            padding-left: 100%;
            animation: scroll-left 120s linear infinite;
        }
        @keyframes scroll-left {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }
/* MAIN PROGRESS BAR */
        #total-progress-container {
            width: 60%; /* Occupies 60% of the left side */
            height: 25px;
            border: 2px inset #ffffff;
            background: #808080;
            margin-top: 10px;
            position: relative;
        }
        #total-progress-fill {
            height: 100%;
            background: repeating-linear-gradient(
                45deg,
                #000080,
                #000080 10px,
                #0000cc 10px,
                #0000cc 20px
            ); /* Classic Blue Striped Bar */
            width: 0%;
            transition: width 0.5s ease;
        }


/* POPCORN EXPLOSION */
        .popcorn-kernel {
            position: fixed;
            bottom: -50px; /* Start hidden at bottom */
            left: 50%;     /* Start at horizontal center */
            font-size: 2rem;
            z-index: 10006; /* Top of the stack */
            pointer-events: none; /* Click through it */
            animation: pop-up-down 3s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }


        @keyframes pop-up-down {
            0% { 
                transform: translate(-50%, 0) scale(0.5) rotate(0deg); 
                opacity: 1; 
            }
            40% { 
                /* Shoot UP to random height (handled by JS var) */
                transform: translate(var(--x-spread), var(--y-height)) scale(1.2) rotate(180deg); 
                opacity: 1; 
            }
            100% { 
                /* Fall DOWN and Fade */
                transform: translate(var(--x-end), 100px) scale(1) rotate(360deg); 
                opacity: 0; 
            }
        }






    </style>
</head>
<body>




<div id="loading-stage">
    <div id="static-noise"></div>
    <div id="scanline"></div>


    <div class="system-boot">SYSTEM BOOT</div>
    <div id="loading-text">INITIALIZING...</div>
</div>






<div id="app-container">
    <header> 🎥 CINE-LOG 2000: THE 365 MOVIE CHALLENGE </header>






    <div id="auth-section" class="box">
<div style="background: #000; color: #0f0; font-family: 'Courier New', monospace; padding: 5px; border: 1px solid #fff; margin-bottom: 15px; text-align: center;">
    WELCOME TO THE CINE-LOG 2000. ENJOY THE SHOW.
</div>
>
       <h3>Sign On</h3>
        
        <div style="margin-bottom: 15px;">
            Email:<br> 
            <input type="email" id="email" style="width: 90%; margin-bottom: 10px;"><br>
            Password:<br> 
            <input type="password" id="password" style="width: 90%;">
        </div>


        <button onclick="login()" class="ticket-btn" style="background: #0044ff; border-color: #000088; margin-left: 0; width: 160px;">ENTER THEATER</button>


    </div>








    <div id="main-content" style="display:none;">
<div class="scroller-container">
    <div id="marquee-text" class="scrolling-text">Loading quotes...</div>
</div>




        <div class="box">
           <div style="float:right;">
<button class="ticket-btn" onclick="toggleNoir()" style="background: #333; border-color: #000; color: #fff; margin-bottom: 10px;">🕵️ NOIR MODE</button>
                <button class="ticket-btn" onclick="logout()">LOGOUT</button>
                
                <button class="ticket-btn" onclick="exportData()" style="background: #ffcc00; color: black; border-color: #c90;">💾 EXPORT</button>
            </div>


     
            
            <div style="padding-top: 5px;">
                <strong>🏆 PROGRESS:</strong> <span id="movie-count" class="counter-pill">0</span> / 365
                
                <div id="total-progress-container">
                    <div id="total-progress-fill"></div>
                </div>
</div>


            <div style="clear:both;"></div>
        </div>










        <div class="box">
            <strong>LOG A NEW FILM:</strong><br><br>
            Date: <input type="date" id="movie-date">
            Title: <input type="text" id="movie-title" placeholder="e.g. Jurassic Park">
            Rating: <select id="movie-rating"><option value="5">⭐⭐⭐⭐⭐</option><option value="4">⭐⭐⭐⭐</option><option value="3">⭐⭐⭐</option><option value="2">⭐⭐</option><option value="1">⭐</option></select>
          <button onclick="saveMovie()" class="ticket-btn" style="display: inline-block; background: #0044ff; border-color: #000088; width: 150px; vertical-align: middle; margin-left: 20px; margin-top: 15px;"> SAVE TO VAULT</button>
        </div>








        <table>
            <thead><tr><th>DATE</th><th>MOVIE TITLE (CLICK FOR INFO)</th><th>RATING</th><th>X</th></tr></thead>
            <tbody id="table-body"></tbody>
        </table>
    </div>
</div>








<div id="movie-modal"><div class="modal-content"><div class="modal-header">&nbsp; FILM INFO</div><div id="modal-body">Loading...</div><br><button onclick="closeModal()">CLOSE WINDOW</button></div></div>








<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
  import { getFirestore, collection, addDoc, query, where, onSnapshot, deleteDoc, doc, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";








  const firebaseConfig = {
    apiKey: "AIzaSyARcsf5jtDzQ-uhcJ3V2nMIVl9JlArWYf8",
    authDomain: "cinelog-7552d.firebaseapp.com",
    projectId: "cinelog-7552d",
    storageBucket: "cinelog-7552d.firebasestorage.app",
    messagingSenderId: "180492873924",
    appId: "1:180492873924:web:d059c63c0aca97b327d991",
    measurementId: "G-JT3NPFZ5RH"
  };








  const OMDB_API_KEY = "ccc0f514"; // <--- PUT YOUR KEY HERE!








  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  let moviesData = [];
const quoteList = [
      "🦖 Hold on to your butts (Jurassic Park)",
      "🍫 Life is like a box of chocolates (Forrest Gump)",
      "👻 I see dead people (The Sixth Sense)",
      "👽 E.T. phone home (E.T.)",
      "🛳️ I'm the king of the world! (Titanic)",
      "💊 Red pill or blue pill? (The Matrix)",
      "🦁 Everything the light touches is our kingdom (The Lion King)",
      "🚀 To infinity and beyond! (Toy Story)",
      "🥊 Yo, Adrian! (Rocky)",
      "🌪️ There's no place like home (The Wizard of Oz)",
      "🦈 You're gonna need a bigger boat (Jaws)",
      "💰 Show me the money! (Jerry Maguire)",
      "🕰️ Great Scott! (Back to the Future)",
      "🎄 Keep the change, ya filthy animal (Home Alone)",
      "🤖 I'll be back (The Terminator)"
  ];










  window.login = () => signInWithEmailAndPassword(auth, email.value, password.value).catch(e => alert(e.message));
  window.logout = () => signOut(auth);
window.toggleNoir = () => {
      document.body.classList.toggle('noir-mode');
  };


  window.closeModal = () => { document.getElementById('movie-modal').style.display = "none"; };








 // --- UPDATED SHOW INFO WITH GENRE, RUNTIME, & ROTTEN TOMATOES ---
  window.showInfo = async (title) => {
    const modal = document.getElementById('movie-modal');
    const body = document.getElementById('modal-body');
    modal.style.display = "block";
    body.innerHTML = "Searching Database...";
    
    try {
        const res = await fetch(`https://www.omdbapi.com/?t=${encodeURIComponent(title)}&apikey=${OMDB_API_KEY}`);
        const data = await res.json();
        
        if(data.Response === "True") {
            // Find the Rotten Tomatoes score in the Ratings array
            const rtRating = data.Ratings.find(r => r.Source === "Rotten Tomatoes");
            const rtScore = rtRating ? rtRating.Value : "N/A";








            body.innerHTML = `
                <img src="${data.Poster}" class="poster">
                <strong>${data.Title}</strong> (${data.Year})<br>
                <strong>Runtime:</strong> ${data.Runtime}<br>
                <strong>Genre:</strong> ${data.Genre}<br>
                <strong>Dir:</strong> ${data.Director}<br>
                <strong>RT Score:</strong> <span style="color:red; font-weight:bold;">🍅 ${rtScore}</span><br>
                <br>
                <strong>Plot:</strong> ${data.Plot}
                <div class="clear"></div>
                <hr>
                <a href="https://www.imdb.com/title/${data.imdbID}" target="_blank">View on IMDb</a>
            `;
        } else { body.innerHTML = "Movie not found."; }
    } catch (e) { body.innerHTML = "Connection error."; }
  };












// --- POPCORN EFFECT ---
  window.triggerPopcorn = () => {
      const audio = new Audio('https://www.soundjay.com/misc/sounds/popcorn-popping-1.mp3'); 
      // Optional: Remove the line above if you don't want sound
      // audio.play().catch(() => {}); // Simple play attempt
      
      for(let i=0; i<60; i++) {
          const p = document.createElement('div');
          p.innerHTML = "🍿";
          p.className = "popcorn-kernel";
          
          // Randomize Physics
          const xSpread = (Math.random() - 0.5) * 80; // Spread Left/Right (vw)
          const yHeight = -60 - (Math.random() * 40); // Shoot Up 60-100% of screen (vh)
          const duration = 2 + Math.random() * 2;     // Lasts 2-4 seconds
          
          p.style.setProperty('--x-spread', xSpread + "vw");
          p.style.setProperty('--x-end', (xSpread * 1.5) + "vw"); // Drift slightly more falling
          p.style.setProperty('--y-height', yHeight + "vh");
          p.style.animationDuration = duration + "s";
          
          document.body.appendChild(p);
          
          // Cleanup after animation
          setTimeout(() => p.remove(), duration * 1000);
      }
  };




window.saveMovie = () => {
    const title = document.getElementById('movie-title').value;
    const date = document.getElementById('movie-date').value;
    const rating = document.getElementById('movie-rating').value;
    
    if(title && date) { 
        // 1. Save to Database
        addDoc(collection(db, "movies"), { uid: auth.currentUser.uid, title, date, rating: parseInt(rating) })
        .then(() => { 
            document.getElementById('movie-title').value = ""; 
            
            // 2. TRIGGER THE EXPLOSION! 🍿
            triggerPopcorn(); 
        }); 
    }
  };










  window.deleteEntry = (id) => { if(confirm("Delete?")) deleteDoc(doc(db, "movies", id)); };






onAuthStateChanged(auth, user => {
    if (user) {
        // --- 1. HIDE LOGIN & PREPARE ---
        document.getElementById('auth-section').style.display = 'none';


        // --- 2. RUN HACKER LOADING SEQUENCE ---
        const loader = document.getElementById('loading-stage');
        if (loader) {
            loader.style.display = "flex"; // Show black screen
            
            const phrases = [
                "📼 REWINDING TAPE...",
                "🍿 POPPING POPCORN...",
                "🔌 JIGGLING THE CABLE...",
                "👽 CONTACTING MOTHERSHIP...",
                "💾 DECRYPTING DATABASE..."
            ];
            
            let i = 0;
            // Update text every 0.8 seconds
            const interval = setInterval(() => {
                const textZone = document.getElementById('loading-text');
                if(textZone) {
                    textZone.innerHTML = `
                        <br>CINE-LOG 2000<br><br>
                        ${phrases[i % phrases.length]}<br><br>
                        <div id="progress-container"><div id="progress-bar" style="width:${(i+1)*20}%"></div></div>
                    `;
                }
                i++;
            }, 800);


            // Stop after 4.5 seconds and show app
            setTimeout(() => {
                clearInterval(interval);
                loader.style.display = 'none'; // Hide loader
                document.getElementById('main-content').style.display = 'block'; // Show App
                
                // Start Marquee
                const tickerText = quoteList.join("  *** ");
                const marquee = document.getElementById('marquee-text');
                if(marquee) marquee.innerText = tickerText;
            }, 4500);
        } else {
            // Fallback if HTML is missing
            document.getElementById('main-content').style.display = 'block';
        }


        // --- 3. FETCH & DISPLAY MOVIES ---
        const q = query(collection(db, "movies"), where("uid", "==", user.uid), orderBy("date", "desc"));
        onSnapshot(q, (snapshot) => {
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = "";
            let lastMonth = "";
            moviesData = [];
            
            snapshot.forEach(docSnap => {
                const m = docSnap.data();
                moviesData.push(m);
                const dateObj = new Date(m.date + "T00:00:00");
                const currentMonth = dateObj.toLocaleString('default', { month: 'long', year: 'numeric' });
                
                if (currentMonth !== lastMonth) {
                    tbody.innerHTML += `<tr><td colspan="4" class="month-header">--- ${currentMonth} ---</td></tr>`;
                    lastMonth = currentMonth;
                }
                
                tbody.innerHTML += `
                    <tr> 
                        <td>${m.date}</td> 
                        <td><span class="movie-link" onclick="showInfo(\`${m.title.replace(/`/g, "\\`").replace(/'/g, "\\'")}\`)">${m.title}</span></td> 
                        <td>${"⭐".repeat(m.rating)}</td> 
                        <td style="text-align:center;">
                            <button class="del-btn" onclick="deleteEntry('${docSnap.id}')">🗑️</button>
                        </td> 
                    </tr>`;
            });
           // Update the Number
            const count = moviesData.length;
            document.getElementById('movie-count').innerText = count;
            
            // Update the Blue Bar
            const percent = (count / 365) * 100;
            document.getElementById('total-progress-fill').style.width = percent + "%";


        });


    } else {
        // --- NO USER? SHOW LOGIN ---
        document.getElementById('auth-section').style.display = 'block';
        document.getElementById('main-content').style.display = 'none';
    }
  });












  window.exportData = () => {
    let content = "365 CHALLENGE LOG\n\n";
    moviesData.forEach(m => content += `[${m.date}] ${m.title} (${m.rating}/5)\n`);
    const blob = new Blob([content], { type: "text/plain" });
    const a = Object.assign(document.createElement("a"), { href: URL.createObjectURL(blob), download: "movie_log.txt" });
    a.click();
  };
</script>
</body>
</html>