<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cine-Log 2000 - Your Movie Vault</title>
    <style>
        body { background-color: #008080; font-family: "Times New Roman", Times, serif; color: black; }
        #app-container { width: 90%; max-width: 800px; margin: 20px auto; background: #c0c0c0; border: 4px outset #ffffff; padding: 10px; }
        header { background: linear-gradient(90deg, #000080, #0808ff); color: white; padding: 5px; font-weight: bold; border: 2px inset #ffffff; margin-bottom: 10px; }
        .login-box, .movie-entry { border: 2px inset #ffffff; background: #c0c0c0; padding: 10px; margin-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; background: white; border: 2px inset #808080; }
        th { background: #808080; color: white; border: 1px solid #c0c0c0; }
        td { border: 1px solid #808080; padding: 5px; }
        input, select { border: 2px inset #ffffff; font-family: "Courier New", Courier, monospace; }
        button { background: #c0c0c0; border: 2px outset #ffffff; cursor: pointer; font-weight: bold; }
        button:active { border: 2px inset #ffffff; }
        .status-light { color: green; font-weight: bold; font-size: 0.8em; }
        marquee { background: #ffff00; color: black; font-weight: bold; border: 1px solid black; }
    </style>
</head>
<body>


<div id-="app-container">
    <header> 🎬 CINE-LOG 2000: MOVIE DATABASE </header>
    <marquee>WELCOME TO YOUR PERSONAL MOVIE TRACKER! AUTO-SAVE IS ENABLED!</marquee>


    <div id="auth-section" class="login-box">
        <strong>Member Login:</strong>
        <input type="email" id="email" placeholder="Email">
        <input type="password" id="password" placeholder="Password">
        <button onclick="login()">Login</button>
        <button onclick="signup()">Sign Up</button>
    </div>


    <div id="main-content" style="display:none;">
        <div class="movie-entry">
            <strong>Add New Entry:</strong><br>
            Date: <input type="date" id="movie-date">
            Title: <input type="text" id="movie-title" placeholder="Star Wars...">
            Rating: 
            <select id="movie-rating">
                <option value="5">⭐⭐⭐⭐⭐</option>
                <option value="4">⭐⭐⭐⭐</option>
                <option value="3">⭐⭐⭐</option>
                <option value="2">⭐⭐</option>
                <option value="1">⭐</option>
            </select>
            <span id="save-status" class="status-light"></span>
        </div>


        <table id="movie-list">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Movie Title</th>
                    <th>Rating</th>
                </tr>
            </thead>
            <tbody id="table-body">
                </tbody>
        </table>
    </div>
</div>


<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
  import { getFirestore, collection, addDoc, query, where, onSnapshot, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";


  // YOUR FIREBASE CONFIG GOES HERE (See Step 2)
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT.appspot.com",
    messagingSenderId: "YOUR_ID",
    appId: "YOUR_APP_ID"
  };


  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);


  // Auth Logic
  window.login = () => {
    signInWithEmailAndPassword(auth, email.value, password.value).catch(err => alert(err.message));
  };
  window.signup = () => {
    createUserWithEmailAndPassword(auth, email.value, password.value).catch(err => alert(err.message));
  };


  onAuthStateChanged(auth, user => {
    if (user) {
        document.getElementById('auth-section').style.display = 'none';
        document.getElementById('main-content').style.display = 'block';
        loadMovies(user.uid);
    }
  });


  // Auto-Save Logic
  const inputs = ['movie-date', 'movie-title', 'movie-rating'];
  inputs.forEach(id => {
    document.getElementById(id).addEventListener('change', () => {
        const title = document.getElementById('movie-title').value;
        const date = document.getElementById('movie-date').value;
        const rating = document.getElementById('movie-rating').value;


        if(title && date) {
            document.getElementById('save-status').innerText = "Saving...";
            addDoc(collection(db, "movies"), {
                uid: auth.currentUser.uid,
                title, date, rating, timestamp: Date.now()
            }).then(() => {
                document.getElementById('save-status').innerText = "✅ Saved!";
                document.getElementById('movie-title').value = "";
            });
        }
    });
  });


  function loadMovies(uid) {
    const q = query(collection(db, "movies"), where("uid", "==", uid), orderBy("date", "desc"));
    onSnapshot(q, (snapshot) => {
        const tbody = document.getElementById('table-body');
        tbody.innerHTML = "";
        snapshot.forEach(doc => {
            const data = doc.data();
            tbody.innerHTML += `<tr><td>${data.date}</td><td>${data.title}</td><td>${"⭐".repeat(data.rating)}</td></tr>`;
        });
    });
  }
</script>
</body>
</html>